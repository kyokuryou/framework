<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:sec="http://www.springframework.org/schema/security"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/security
       http://www.springframework.org/schema/security/spring-security-3.1.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <!-- 该路径下的资源不用过滤 -->
    <sec:http pattern="/" security="none"/>
    <sec:http pattern="/common/**" security="none"/>
    <sec:http pattern="/admin/admin!login.action" security="none"/>

    <sec:http auto-config="true" access-decision-manager-ref="secAccessDecision" servlet-api-provision="false"
              access-denied-page="/html/error_page_access_denied.html">

        <sec:form-login login-page="/admin/admin!login.action" login-processing-url="/admin/loginVerify"
                        default-target-url="/admin/admin!main.action"
                        authentication-failure-url="/admin/admin!login.action" always-use-default-target="true"/>

        <sec:remember-me key="e37f8888-0ooo-22dd-bd0b-9900211c9a66"/>

        <sec:logout invalidate-session="true" logout-success-url="/admin/admin!login.action"
                    logout-url="/admin/logout"/>

        <sec:session-management invalid-session-url="/timeout.jsp">
            <sec:concurrency-control max-sessions="1" error-if-maximum-exceeded="true"/>
        </sec:session-management>

        <sec:custom-filter before="FILTER_SECURITY_INTERCEPTOR" ref="secFilter"/>

    </sec:http>

    <sec:authentication-manager alias="authenticationManager">
        <sec:authentication-provider user-service-ref="secAuthentication">
            <sec:password-encoder hash="md5"/>
        </sec:authentication-provider>
    </sec:authentication-manager>
</beans>